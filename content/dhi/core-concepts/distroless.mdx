---
title: ミニマル / Distroless イメージ
description: Docker Hardened Images が、Distroless バリアントを利用して攻撃対象領域を最小化し、不要なコンポーネントを排除する方法について学びましょう。
---

# ミニマル / Distroless イメージ

ミニマルイメージ（Distroless イメージとも呼ばれる）は、パッケージマネージャやシェル、さらには基盤となる OS ディストリビューションといった不要なコンポーネントを削ぎ落としたコンテナイメージです。

Docker Hardened Images（DHI）は、このミニマルアプローチを採用することで、脆弱性を減らし、セキュアなソフトウェアデリバリーを実現しています。

[Docker Official Images](https://docs.docker.com/docker-hub/image-library/trusted-content/#docker-official-images) や [Docker Verified Publisher Images](https://docs.docker.com/docker-hub/image-library/trusted-content/#verified-publisher-images) も、同様にミニマル化とセキュリティに関するベストプラクティスに従っています。

ただし、より幅広いユースケースとの互換性を維持するために、DHI ほど徹底して削ぎ落とされていない場合があります。

## ミニマル / Distroless イメージとは？

従来のコンテナイメージは、アプリケーションの実行に必要以上のものを含む フル OS を搭載していることが多くあります。
それに対して、ミニマル / Distroless イメージには以下のみが含まれます：

- アプリケーションのバイナリ

- 実行に必要な依存関係（例：libc、Java、Python）

- 明示的に必要とされる設定やメタデータ

一方で、通常は以下が除外されます:

- OS ツール（例：`ls`、`ps`、`cat`）

- シェル（例：`sh`、`bash`）

- パッケージマネージャ（例：`apt`、`apk`）

- デバッグ用ユーティリティ（例：`curl`、`wget`、`strace`）

Docker Hardened Images はこのモデルに基づいて設計されており、より小さく、よりセキュアな実行環境を提供します。

## 得られるメリット

| メリット             | 説明                                                                          |
|--------------------|-------------------------------------------------------------------------------|
| 攻撃対象領域の縮小    | コンポーネントが少ないほど脆弱性も減り、CVE の露出も最小限に抑えられます。                |
| 起動の高速化         | イメージサイズが小さいため、pull と起動がより速くなります。                            |
| セキュリティの向上    | シェルやパッケージマネージャがないことで、侵害された場合でも攻撃者ができることを制限できます。|
| コンプライアンスの向上 | SBOM やアテステーションにより監査や検証が容易になります。                             |

## 一般的なトレードオフへの対応

ミニマル / Distroless イメージは強力なセキュリティ上の利点をもたらしますが、コンテナの扱い方に影響を与えることもあります。

Docker Hardened Images は、生産性を維持しつつセキュリティを強化できるよう設計されています。

| 課題           | Docker Hardened Images の支援方法                                                                                                                                                                                                |
|---------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| デバッグ性      | Hardened イメージはデフォルトでシェルや CLI ツールを含みません。 [Docker Debug](https://docs.docker.com/reference/cli/docker/debug/) を使用して、一時的にデバッグ用サイドカーをアタッチすることで、元のコンテナを変更せずにトラブルシューティングできます。|
| 慣れ親しんだ環境 | DHI は Alpine や Debian など複数のベースイメージをサポートしているため、ハードニングの恩恵を受けつつ、使い慣れた環境を選択できます。                                                                                                              |
| 柔軟性         | 実行時の不変性はコンテナのセキュリティを強化します。マルチステージビルドや CI/CD を活用して変更を管理し、開発中は必要に応じて開発者向けのベースイメージを利用することも可能です。                                                                           |

ミニマリズムと実用的なツールをバランスよく組み合わせることで、Docker Hardened Images はセキュリティや信頼性を損なうことなく、モダンな開発ワークフローを支援します。

## ミニマルイメージを使用する際のベストプラクティス

- マルチステージビルドを活用し、ビルド時と実行時の環境を分離する

- インタラクティブな確認ではなく、CI パイプラインを通じてイメージの挙動を検証する

- 実行時に必要な依存関係は Dockerfile 内で明示的に記述する

- Docker Scout を活用して、ミニマルイメージであっても継続的に CVE を監視する

Docker Hardened Images を通じてミニマル / Distroless イメージを採用することで、よりセキュアで予測可能、本番対応可能なコンテナ環境を実現できます。

これは、自動化・明確性・リスク削減を重視した設計に基づいています。
